{
	"WS12DEV1": {
		"daemons_comments": [
			"On top of this host configuration, the daemons which will dictate the host behavior, and mainly whether is it a backup production host or not.",
			"- ...",
			""
		],
		"daemons": [
		],
		"ServicesComments": [
			"These are the services defined on this host as objects where the top key if the name of the service. At least this top key should be specified, even if with an empty properties object.",
			"Values may be:",
			"- dbms: a hash of the involved DBMS objects, where the top key is the instance name and values may be:",
			"  > databases: an array of the involved databases names in this instance",
			"- ...",
			"- A service can define a 'workloads' hash of parameters to be given to the specified workload.",
			"  E.g. we have a 'daily.morning' workload, executed at the very beginning of each day. This workload is responsible to purge logs, have a database full backup, check for available space, and so on.",
			"  And we also have a 'daily.periodic.2h' workload for differential backups of live production databases.",
			"  We could so define any workload in any service...",
			"  'workloads' is a hash whose keys are the name of each workload this service subscribes to, values being an (ordered) array of the work tasks associated to this workload for this service.",
			"  Each work task is a hash whose content depends mainly of the particular involved workload, but may have:",
			"  > a 'label'",
			"  > an array of 'commands'",
			"  > the order as an optional integer",
			"    A word of caution: due to the way Perl::JSON interprets the zero integer of the '0' string, do not use these values!",
			"    For consistency reasons, you should rather use only strings.",
			"    Due to the above Perl 'not-a-bug-but-a-feature', do not use single zero, either as a string nor an integer.",
			"- ...",
			""
		],
		"Services": {
			"Canal33": {
				"instance": "DEV",
				"databases": [
					"Canal33"
				],
				"workloads": {
				},
				"monitor": {
					"ovh": {
						"ip": "ip-87.98.189.58"
					},
					"url": "http://canal33.sysnrg.com",
					"switch": {
						"scheduled": "\\Inlingua\\tom17.backup.startup"
					}
				}
			},
			"Dom.2008": {
				"instance": "DEV",
				"databases": [
					"Dom1",
					"Dom33"
				],
				"workloads": {
					"daily.morning": [
						{
							"label": "Databases backup",
							"commands": [
								"dbms.pl backup -nocolored -service Dom.2008 -full"
							]
						}
					]
				},
				"status": {
					"commands_comments": [
						"Because these commands are also expected to test URLs, they have to be run from a machine outside of our two main physicals which both hold the FailOver IPs",
						"Hence a crontab in an external Linux machine. Hence the below ssh.."
					],
					"commands": [
						"ssh inlingua-user@<HOST> dbms.pl status -nocolored -service <SERVICE> -state -mqtt -http",
						"http.pl get -nocolored -url http://ip1.test.blingua.net -label service=<SERVICE> -http"
					],
					"live_comments": [
						"A command which let us determine where is the live production. This is a single command as we manage a single live production",
						"Only useful when about to switch a machine status to or from live or backup"
					],
					"get_live": "http.pl get -nocolored -url http://ip.test.blingua.net -header X-Sent-By -accept ..."
				},
				"switch_comments": [
					"These commands have to be run when we want switch the status of a machine, from live to backup, or from backup to live",
					"They have to be run via 'SiteResources\\Commands\\extern_service_switch.pl' script."
				],
				"switch": {
					"to_backup": {
						"commands": [
							"ssh inlingua-adm@<HOST> sc stop Canal33Ftp",
							"ssh inlingua-adm@<HOST> sc config start= disabled Canal33Ftp",
							"ssh inlingua-adm@<HOST> sc stop Canal33Svc",
							"ssh inlingua-adm@<HOST> sc config start= disabled Canal33Svc"
						]
					},
					"to_live": {
						"commands": [
							"ssh inlingua-user@<HOST> daemon.pl stop -nocolored -json [eval:File::Spec->catdir( $TTPVars->{config}{site}{daemonsDir}, 'canal33-backup-monitor-daemon.json' )] -ignore -wait",
							"ssh inlingua-adm@<HOST> [eval:File::Spec->catdir( $TTPVars->{config}{site}{commandsDir}, 'scheduled_set_status.cmd' )] \\Inlingua\\tom17.backup.startup /Disable",
							"ssh inlingua-adm@<HOST> sc config start= auto Canal33Ftp",
							"ssh inlingua-adm@<HOST> sc start Canal33Ftp",
							"ssh inlingua-adm@<HOST> sc config start= auto Canal33Svc",
							"ssh inlingua-adm@<HOST> sc start Canal33Svc",
							"ovh.pl ipswitch -ip ip-87.98.189.58 -to ns3153065.ip-51-91-25.eu -wait http://ip.test.blingua.net"
						]
					}
				}
			},
			"Technical Workloads": {
				"hidden": true,
				"workloads": {
					"daily.morning": [
						{
							"label": "Purge directories",
							"order": "00",
							"commands": [
								"ttp.pl purgedirs -nocolored -dircmd \"dbms.pl vars -nocolored -backupsRoot\" -keep 7",
								"ttp.pl purgedirs -nocolored -dircmd \"dbms.pl vars -nocolored -archivesRoot\" -keep 7",
								"ttp.pl purgedirs -nocolored -dircmd \"ttp.pl vars -nocolored -logsRoot\" -keep 7"
							]
						}
					],
					"startup": [
						{
							"label": "Advertize at startup",
							"commands": [
								"call [eval:File::Spec->catdir( $TTPVars->{config}{site}{commandsDir}, 'startup.cmd' )]"
							]
						}
					],
					"test1": [
						{
							"label": "test workload",
							"commands_x": [
								"dbms.pl backup -nocolored -instance DEV -database Dom1 -diff",
								"ttp.pl list -nocolored -services"
							],
							"commands": [
								"daemon.pl start -nocolored -json [eval:File::Spec->catdir( $TTPVars->{config}{site}{daemonsDir}, 'tom59-backup-monitor-daemon.json' )] -- -remote NS3232346"
							]
						}
					]
				}
			}
		},
		"DBMSInstancesComments": [
			"These are informations needed to automatize some DBMS-related workloads.",
			"Be conscious that these informations are NOT thought to represent the *running* DBMS, but only those with which we may have something to do...",
			"Each defined instance is associated with an object whose top key is the instance name. Object values may have the following keys:",
			"- package: the Perl package to be dynamically loaded when addressing this instance",
			"- accounts: a hash of accounts where account name is the key, and password the value",
			"- dataPath: the full directory pathname of the database files",
			"- ...",
			""
		],
		"DBMSInstances": {
			"DEV": {
				"package": "Mods::SqlServer",
				"dataPath": "C:\\Program Files\\Microsoft SQL Server\\MSSQL11.DEV\\MSSQL\\DATA"
			}
		},
		"DBMS": {
			"archivesDir": "[eval:File::Spec->catdir( Mods::Path::dbmsArchivesRoot(), localtime->strftime( '%y%m%d' ))]",
			"archivesRoot": "\\[eval:File::Spec->catdir( '\\ftpback-rbx7-618.ovh.net', 'ns3153065.ip-51-91-25.eu', '<HOST>', 'SQLBackups' )]"
		},
		"Environment": {
			"type_comments": [],
			"type": "D"
		},
		"remoteShare": "\\\\10.122.1.14\\C"
	}
}
