{
	"DBMS": {
		"instance": "MSSQLSERVER",
		"databases": [
			"inlingua17a"
		]
	},
	"status": {
		"commands_comments": [
			"Describe here the commands used to periodically check the service status",
			"Commands can be specified at the service level, or at the machine level"
		],
		"commands": [
			"http.pl get -nocolored -url https://tom17.blingua.fr -accept [1-3].. -mqtt -http -- -metric ttp_url_status -label service=<SERVICE> -label environment=X",
			"http.pl get -nocolored -url https://inlingua17.blingua.fr -accept [1-3].. -mqtt -http -- -metric ttp_url_status -label service=<SERVICE> -label environment=X",
			"http.pl get -nocolored -url https://tom17.backup.blingua.fr -accept [1-3].. -mqtt -http -- -metric ttp_url_status -label service=<SERVICE> -label environment=X"
		],
		"byHost": {
			"commands": [
				"ssh inlingua-user@<HOST> dbms.pl status -nocolored -service <SERVICE> -state -mqtt -http",
				"ssh inlingua-user@<HOST> daemon.pl status -bname tom17-backup-monitor-daemon.json -http -- -metric ttp_service_daemon -label service=<SERVICE> -label role=backup -label environment=X"
			]
		}
	},
	"workloads": {
		"tom17.live.morning": [
			{
				"label": "(Production Live) Sauvegarde quotidienne de la base de données Tom17",
				"commands": [
					"dbms.pl backup -nocolored -service Tom17 -full",
					"dbms.pl telemetry -nocolored -service Tom17 -dbsize",
					"dbms.pl telemetry -nocolored -service Tom17 -tabcount"
				]
			}
		],
		"tom17.live.every.2h": [
			{
				"label": "(Production Live) Sauvegarde différentielle sur la base de données Tom17",
				"commands": [
					"dbms.pl backup -nocolored -service Tom17 -diff"
				]
			}
		],
		"tom17.live.evening": [
		],
		"tom17.backup": [
			{
				"label": "(PROD BACKUP) Surveillance, transfert et restauration des sauvegardes de la production",
				"commands": [
					"daemon.pl stop -nocolored -json [eval:File::Spec->catdir( $TTPVars->{config}{site}{daemonsDir}, 'tom17-backup-monitor-daemon.json' )] -ignore -wait",
					"daemon.pl start -nocolored -json [eval:File::Spec->catdir( $TTPVars->{config}{site}{daemonsDir}, 'tom17-backup-monitor-daemon.json' )] -- -remote WS22PROD1"
				]
			}
		]
	}
}
